
DECLARE @tableName NVARCHAR(MAX) = 'dummy.channel_test';
DECLARE @sql NVARCHAR(MAX);

-- Step 1: Create condition to check NULL
DECLARE @nullCondition NVARCHAR(MAX);
SET @nullCondition = (
    SELECT STRING_AGG('[' + NAME + '] IS NULL', ' AND ')
    FROM sys.COLUMNS
    WHERE object_id = OBJECT_ID(@tableName) AND NAME <>'AsOfDate'
);

-- Step 2: SET SQL
SET @sql = 'DELETE FROM ' + @tableName + ' WHERE ' + @nullCondition;

-- Step 3: Execute the query
EXEC(@sql);
