DECLARE @columns NVARCHAR(MAX);
DECLARE @sql NVARCHAR(MAX);

-- Get common columns
SELECT @columns = STRING_AGG(COLUMN_NAME, ', ')
FROM (
    SELECT COLUMN_NAME
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = 'TableA'
    INTERSECT
    SELECT COLUMN_NAME
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = 'TableB'
) AS CommonColumns;

-- Construct the join query
SET @sql = '
SELECT ' + @columns + '
FROM TableA
INNER JOIN TableB
ON TableA.CommonKey = TableB.CommonKey; -- Replace CommonKey with your actual join condition';

-- Execute the query
EXEC sp_executesql @sql;
